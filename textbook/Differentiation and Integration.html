<!DOCTYPE html>
<!-- saved from url=(0055)http://greenteapress.com/thinkdsp/html/thinkdsp010.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252">

<meta name="generator" content="hevea 2.09">
<link rel="stylesheet" type="text/css" href="./Differentiation and Integration_files/thinkdsp.css">
<title>Differentiation and Integration</title>
<style id="dark-reader-style" type="text/css">@media screen {

/* Leading rule */
html {
  -webkit-filter: invert(100%) hue-rotate(180deg) brightness(110%) contrast(90%) grayscale(20%) sepia(10%) !important;
  filter: invert(100%) hue-rotate(180deg) brightness(110%) contrast(90%) grayscale(20%) sepia(10%) !important;
}

/* Reverse rule */
img,
video,
:not(object):not(body)>embed,
object,
svg image,
[style*="background:url"],
[style*="background-image:url"],
[style*="background: url"],
[style*="background-image: url"],
[background],
twitterwidget {
  -webkit-filter: invert(100%) hue-rotate(180deg) !important;
  filter: invert(100%) hue-rotate(180deg) !important;
}
[style*="background:url"] *,
[style*="background-image:url"] *,
[style*="background: url"] *,
[style*="background-image: url"] *,
input,
[background] *,
img[src^="https://s0.wp.com/latex.php"],
twitterwidget .NaturalImage-image {
  -webkit-filter: none !important;
  filter: none !important;
}
.compatibility-with-darkreader-below-4-3-3 {
  background: white !important;
}

/* Text contrast */
html {
  text-shadow: 0 0 0 !important;
}

/* Full screen */
:-webkit-full-screen, :-webkit-full-screen * {
  -webkit-filter: none !important;
  filter: none !important;
}
:-moz-full-screen, :-moz-full-screen * {
  -webkit-filter: none !important;
  filter: none !important;
}
:fullscreen, :fullscreen * {
  -webkit-filter: none !important;
  filter: none !important;
}

/* Page background */
html {
  background: rgb(13,13,12) !important;
}

/* Custom rules */
.compatibility-with-darkreader-below-4-3-3 {
    background: white !important;
}

}</style></head>
<body class="">
<a href="http://greenteapress.com/thinkdsp/html/thinkdsp009.html"><img src="./Differentiation and Integration_files/back.png" alt="Previous"></a>
<a href="http://greenteapress.com/thinkdsp/html/index.html"><img src="./Differentiation and Integration_files/up.png" alt="Up"></a>
<a href="http://greenteapress.com/thinkdsp/html/thinkdsp011.html"><img src="./Differentiation and Integration_files/next.png" alt="Next"></a>
<hr>
<table>

<tbody><tr>

<td valign="top" width="100" bgcolor="#b53f97">
</td>

<td valign="top" width="600" style="padding: 20px 20px;">

<p>This HTML version of is provided for convenience, but it
is not the best format for the book.  In particular, some of the
symbols are not rendered correctly.

</p><p>You might prefer to read
the <a href="http://greenteapress.com/thinkdsp/thinkdsp.pdf">PDF version</a>.

</p><p>
<a href="http://amzn.to/1T8U0mR">You can buy this book at Amazon.</a>
</p><h1 class="chapter" id="sec74"><span class="c003">Chapter&nbsp;9&nbsp;&nbsp;Differentiation and Integration</span></h1>
<p><span class="c003">
</span><a id="diffint"></a></p><p><span class="c003">This chapter picks up where the previous chapter left off,
looking at the relationship between windows in the time domain
and filters in the frequency domain.</span></p><p><span class="c003">In particular, we’ll look at the effect of a finite difference
window, which approximates differentiation, and the cumulative
sum operation, which approximates integration.
</span><a id="hevea_default336"></a><span class="c003">
</span><a id="hevea_default337"></a></p><p><span class="c003">The code for this chapter is in </span><span class="c003"><span class="c002">chap09.ipynb</span></span><span class="c003">, which is in the
repository for this book (see Section&nbsp;</span><a href="http://greenteapress.com/thinkdsp/html/thinkdsp001.html#code"><span class="c003">0.2</span></a><span class="c003">).
You can also view it at </span><a href="http://tinyurl.com/thinkdsp09"><span class="c003"><span class="c002">http://tinyurl.com/thinkdsp09</span></span></a><span class="c003">.</span></p><span class="c003">
</span><h2 class="section" id="sec75"><span class="c003">9.1&nbsp;&nbsp;Finite differences</span></h2>
<p><span class="c003">
</span><a id="diffs"></a></p><p><span class="c003">In Section&nbsp;</span><a href="http://greenteapress.com/thinkdsp/html/thinkdsp009.html#smoothing"><span class="c003">8.1</span></a><span class="c003">, we applied a smoothing window to
the stock price of Facebook and found that a smoothing
window in the time domain corresponds to a low-pass filter in
the frequency domain.</span></p><p><span class="c003">In this section, we’ll look at daily price changes and
see that computing the difference between successive elements,
in the time domain, corresponds to a high-pass filter.
</span><a id="hevea_default338"></a><span class="c003">
</span><a id="hevea_default339"></a></p><p><span class="c003">Here’s the code to read the data, store it as a wave, and compute its
spectrum.</span></p><pre class="verbatim"><span class="c003">    import pandas as pd

    names = ['date', 'open', 'high', 'low', 'close', 'volume']
    df = pd.read_csv('fb.csv', header=0, names=names)
    ys = df.close.values[::-1]
    close = thinkdsp.Wave(ys, framerate=1)
    spectrum = wave.make_spectrum()
</span></pre><p><span class="c003">This example uses Pandas to read the CSV file; the
result is a DataFrame, </span><span class="c003"><span class="c002">df</span></span><span class="c003">, with columns for the opening
price, closing price, and high and low prices. I select the closing
prices and save them in a Wave object.
The frame rate is 1 sample per day. 
</span><a id="hevea_default340"></a></p><p><span class="c003">Figure&nbsp;</span><a href="http://greenteapress.com/thinkdsp/html/thinkdsp010.html#fig.diff_int1"><span class="c003">9.1</span></a><span class="c003"> shows
this time series and its spectrum.
Visually, the time series resembles Brownian noise (see
Section&nbsp;</span><a href="http://greenteapress.com/thinkdsp/html/thinkdsp005.html#brownian"><span class="c003">4.3</span></a><span class="c003">).
And the spectrum looks like a straight
line, albeit a noisy one. The estimated slope is -1.9,
which is consistent with Brownian noise.
</span><a id="hevea_default341"></a></p><blockquote class="figure"><div class="center"><hr class="c015"></div><span class="c003">
</span><div class="center"><span class="c003"><img src="./Differentiation and Integration_files/thinkdsp048.png"></span></div><span class="c003">
</span><div class="caption"><table class="c000 cellpading0"><tbody><tr><td class="c014"><span class="c003">Figure 9.1: Daily closing price of Facebook and the spectrum of this time
series.</span></td></tr>
</tbody></table></div><span class="c003">
</span><a id="fig.diff_int1"></a><span class="c003">
</span><div class="center"><hr class="c015"></div></blockquote><p><span class="c003">Now let’s compute the daily price change using </span><span class="c003"><span class="c002">np.diff</span></span><span class="c003">:</span></p><pre class="verbatim"><span class="c003">    diff = np.diff(ys)
    change = thinkdsp.Wave(diff, framerate=1)
    change_spectrum = change.make_spectrum()
</span></pre><p><span class="c003">Figure&nbsp;</span><a href="http://greenteapress.com/thinkdsp/html/thinkdsp010.html#fig.diff_int2"><span class="c003">9.2</span></a><span class="c003"> shows the resulting wave and its spectrum.
The daily changes resemble white noise, and the estimated slope of the
spectrum, -0.06, is near zero, which is what we expect for white
noise.
</span><a id="hevea_default342"></a></p><blockquote class="figure"><div class="center"><hr class="c015"></div><span class="c003">
</span><div class="center"><span class="c003"><img src="./Differentiation and Integration_files/thinkdsp049.png"></span></div><span class="c003">
</span><div class="caption"><table class="c000 cellpading0"><tbody><tr><td class="c014"><span class="c003">Figure 9.2: Daily price change of Facebook and the spectrum of this time series.</span></td></tr>
</tbody></table></div><span class="c003">
</span><a id="fig.diff_int2"></a><span class="c003">
</span><div class="center"><hr class="c015"></div></blockquote><span class="c003">
</span><h2 class="section" id="sec76"><span class="c003">9.2&nbsp;&nbsp;The frequency domain</span></h2>
<p><span class="c003">Computing the difference
between successive elements is the same as convolution with
the window </span><span class="c003"><span class="c002">[1, -1]</span></span><span class="c003">.
If the order of those elements seems backward,
remember that convolution reverses the window before applying it
to the signal.
</span><a id="hevea_default343"></a><span class="c003">
</span><a id="hevea_default344"></a></p><p><span class="c003">We can see the effect of this operation in the frequency domain
by computing the DFT of the window. 
</span><a id="hevea_default345"></a></p><pre class="verbatim"><span class="c003">    diff_window = np.array([1.0, -1.0])
    padded = thinkdsp.zero_pad(diff_window, len(close))
    diff_wave = thinkdsp.Wave(padded, framerate=close.framerate)
    diff_filter = diff_wave.make_spectrum()
</span></pre><blockquote class="figure"><div class="center"><hr class="c015"></div><span class="c003">
</span><div class="center"><span class="c003"><img src="./Differentiation and Integration_files/thinkdsp050.png"></span></div><span class="c003">
</span><div class="caption"><table class="c000 cellpading0"><tbody><tr><td class="c014"><span class="c003">Figure 9.3: Filters corresponding to the diff and differentiate operators (left) and integration operator (right, log-</span><span class="c003"><span class="c006">y</span></span><span class="c003"> scale).</span></td></tr>
</tbody></table></div><span class="c003">
</span><a id="fig.diff_int3"></a><span class="c003">
</span><div class="center"><hr class="c015"></div></blockquote><p><span class="c003">Figure&nbsp;</span><a href="http://greenteapress.com/thinkdsp/html/thinkdsp010.html#fig.diff_int3"><span class="c003">9.3</span></a><span class="c003"> shows the result. The finite difference
window corresponds to a high-pass filter: its amplitude increases with
frequency, linearly for low frequencies, and then sublinearly after
that. In the next section, we’ll see why.
</span><a id="hevea_default346"></a></p><span class="c003">
</span><h2 class="section" id="sec77"><span class="c003">9.3&nbsp;&nbsp;Differentiation</span></h2>
<p><span class="c003">
</span><a id="effdiff"></a></p><p><span class="c003">The window we used in the previous section is a
numerical approximation of the first derivative, so the filter
approximates the effect of differentiation.
</span><a id="hevea_default347"></a></p><p><span class="c003">Differentiation in the time domain corresponds to a simple filter
in the frequency domain; we can figure out what it is with a little
math.</span></p><p><span class="c003">Suppose we have a complex sinusoid with frequency </span><span class="c003"><span class="c006">f</span></span><span class="c003">:
</span></p><table class="display dcenter"><tbody><tr class="c013"><td class="dcell"><span class="c003"><span class="c006">E</span></span><sub><span class="c003"><span class="c006">f</span></span></sub><span class="c003">(</span><span class="c003"><span class="c006">t</span></span><span class="c003">)&nbsp;=&nbsp;</span><span class="c003"><span class="c006">e</span></span><sup><span class="c003">2&nbsp;&#960;&nbsp;</span><span class="c003"><span class="c006">i</span></span><span class="c003">&nbsp;</span><span class="c003"><span class="c006">f</span></span><span class="c003">&nbsp;</span><span class="c003"><span class="c006">t</span></span></sup><span class="c003">&nbsp;</span></td></tr>
</tbody></table><p><span class="c003">
The first derivative of </span><span class="c003"><span class="c006">E</span></span><sub><span class="c003"><span class="c006">f</span></span></sub><span class="c003"> is
</span></p><table class="display dcenter"><tbody><tr class="c013"><td class="dcell"><table class="display"><tbody><tr><td class="dcell c008"><span class="c003"><span class="c006">d</span></span></td></tr>
<tr><td class="hbar"><span class="c003"></span></td></tr>
<tr><td class="dcell c008"><span class="c003"><span class="c006">dt</span></span></td></tr>
</tbody></table></td><td class="dcell"><span class="c003">&nbsp;</span><span class="c003"><span class="c006">E</span></span><sub><span class="c003"><span class="c006">f</span></span></sub><span class="c003">(</span><span class="c003"><span class="c006">t</span></span><span class="c003">)&nbsp;=&nbsp;2&nbsp;&#960;&nbsp;</span><span class="c003"><span class="c006">i</span></span><span class="c003">&nbsp;</span><span class="c003"><span class="c006">f</span></span><span class="c003">&nbsp;</span><span class="c003"><span class="c006">e</span></span><sup><span class="c003">2&nbsp;&#960;&nbsp;</span><span class="c003"><span class="c006">i</span></span><span class="c003">&nbsp;</span><span class="c003"><span class="c006">f</span></span><span class="c003">&nbsp;</span><span class="c003"><span class="c006">t</span></span></sup><span class="c003">&nbsp;</span></td></tr>
</tbody></table><p><span class="c003">
which we can rewrite as
</span></p><table class="display dcenter"><tbody><tr class="c013"><td class="dcell"><table class="display"><tbody><tr><td class="dcell c008"><span class="c003"><span class="c006">d</span></span></td></tr>
<tr><td class="hbar"><span class="c003"></span></td></tr>
<tr><td class="dcell c008"><span class="c003"><span class="c006">dt</span></span></td></tr>
</tbody></table></td><td class="dcell"><span class="c003">&nbsp;</span><span class="c003"><span class="c006">E</span></span><sub><span class="c003"><span class="c006">f</span></span></sub><span class="c003">(</span><span class="c003"><span class="c006">t</span></span><span class="c003">)&nbsp;=&nbsp;2&nbsp;&#960;&nbsp;</span><span class="c003"><span class="c006">i</span></span><span class="c003">&nbsp;</span><span class="c003"><span class="c006">f</span></span><span class="c003">&nbsp;</span><span class="c003"><span class="c006">E</span></span><sub><span class="c003"><span class="c006">f</span></span></sub><span class="c003">(</span><span class="c003"><span class="c006">t</span></span><span class="c003">)&nbsp;</span></td></tr>
</tbody></table><p><span class="c003">
In other words, taking the derivative of </span><span class="c003"><span class="c006">E</span></span><sub><span class="c003"><span class="c006">f</span></span></sub><span class="c003"> is the same
as multiplying by </span><span class="c003">2 &#960; </span><span class="c003"><span class="c006">i</span></span><span class="c003"> </span><span class="c003"><span class="c006">f</span></span><span class="c003">, which is a complex number
with magnitude </span><span class="c003">2 &#960; </span><span class="c003"><span class="c006">f</span></span><span class="c003"> and angle </span><span class="c003">&#960;/2</span><span class="c003">.</span></p><p><span class="c003">We can compute the filter that corresponds to differentiation,
like this:</span></p><pre class="verbatim"><span class="c003">    deriv_filter = close.make_spectrum()
    deriv_filter.hs = PI2 * 1j * deriv_filter.fs
</span></pre><p><span class="c003">I started with the spectrum of </span><span class="c003"><span class="c002">close</span></span><span class="c003">, which has the right
size and frame rate, then replaced the </span><span class="c003"><span class="c002">hs</span></span><span class="c003"> with </span><span class="c003">2 &#960; </span><span class="c003"><span class="c006">i</span></span><span class="c003"> </span><span class="c003"><span class="c006">f</span></span><span class="c003">.
Figure&nbsp;</span><a href="http://greenteapress.com/thinkdsp/html/thinkdsp010.html#fig.diff_int3"><span class="c003">9.3</span></a><span class="c003"> (left) shows this filter; it is a straight line.
</span><a id="hevea_default348"></a></p><p><span class="c003">As we saw in Section&nbsp;</span><a href="http://greenteapress.com/thinkdsp/html/thinkdsp008.html#synthmat"><span class="c003">7.4</span></a><span class="c003">, multiplying a complex sinusoid
by a complex number has two effects: it multiplies
the amplitude, in this case by </span><span class="c003">2 &#960; </span><span class="c003"><span class="c006">f</span></span><span class="c003">, and shifts the phase
offset, in this case by </span><span class="c003">&#960;/2</span><span class="c003">.</span></p><p><span class="c003">If you are familiar with the language of operators and eigenfunctions,
each </span><span class="c003"><span class="c006">E</span></span><sub><span class="c003"><span class="c006">f</span></span></sub><span class="c003"> is an eigenfunction of the differentiation operator, with the
corresponding eigenvalue </span><span class="c003">2 &#960; </span><span class="c003"><span class="c006">i</span></span><span class="c003"> </span><span class="c003"><span class="c006">f</span></span><span class="c003">. See
</span><a href="http://en.wikipedia.org/wiki/Eigenfunction"><span class="c003"><span class="c002">http://en.wikipedia.org/wiki/Eigenfunction</span></span></a><span class="c003">.
</span><a id="hevea_default349"></a><span class="c003">
</span><a id="hevea_default350"></a></p><p><span class="c003">If you are not familiar with that language, here’s what it
means:</span></p><ul class="itemize"><li class="li-itemize"><span class="c003">An operator is a function that takes a function and returns
another function. For example, differentiation is an operator.</span></li><li class="li-itemize"><span class="c003">A function, </span><span class="c003"><span class="c006">g</span></span><span class="c003">, is an eigenfunction of an operator, </span><span class="c003"><span style="color:red"><span class="c006">A</span></span></span><span class="c003">, if
applying </span><span class="c003"><span style="color:red"><span class="c006">A</span></span></span><span class="c003"> to </span><span class="c003"><span class="c006">g</span></span><span class="c003"> has the effect of multiplying the function by
a scalar. That is, </span><span class="c003"><span style="color:red"><span class="c006">A</span></span></span><span class="c003"> </span><span class="c003"><span class="c006">g</span></span><span class="c003"> = &#955; </span><span class="c003"><span class="c006">g</span></span><span class="c003">.</span></li><li class="li-itemize"><span class="c003">In that case, the scalar </span><span class="c003">&#955;</span><span class="c003"> is the eigenvalue that
corresponds to the eigenfunction </span><span class="c003"><span class="c006">g</span></span><span class="c003">.
</span><a id="hevea_default351"></a></li><li class="li-itemize"><span class="c003">A given operator might have many eigenfunctions, each with
a corresponding eigenvalue. </span></li></ul><p><span class="c003">Because complex sinusoids are eigenfunctions of the differentiation
operator, they are easy to differentiate. All we have to do is
multiply by a complex scalar.
</span><a id="hevea_default352"></a></p><p><span class="c003">For signals with more than one
component, the process is only slightly harder:</span></p><ol class="enumerate" type="1"><li class="li-enumerate"><span class="c003">Express the signal as the sum of complex sinusoids.</span></li><li class="li-enumerate"><span class="c003">Compute the derivative of each component by multiplication.</span></li><li class="li-enumerate"><span class="c003">Add up the differentiated components.</span></li></ol><p><span class="c003">If that process sounds familiar, that’s because it is identical
to the algorithm for convolution in Section&nbsp;</span><a href="http://greenteapress.com/thinkdsp/html/thinkdsp009.html#effconv"><span class="c003">8.6</span></a><span class="c003">: compute
the DFT, multiply by a filter, and compute the inverse DFT.
</span><a id="hevea_default353"></a></p><p><span class="c003"><span class="c002">Spectrum</span></span><span class="c003"> provides a method that applies the differentiation
filter:</span></p><pre class="verbatim"><span class="c003"># class Spectrum:

    def differentiate(self):
        self.hs *= PI2 * 1j * self.fs
</span></pre><p><span class="c003">We can use it to compute the derivative of the Facebook time series:</span></p><pre class="verbatim"><span class="c003">    deriv_spectrum = close.make_spectrum()
    deriv_spectrum.differentiate()
    deriv = deriv_spectrum.make_wave()
</span></pre><blockquote class="figure"><div class="center"><hr class="c015"></div><span class="c003">
</span><div class="center"><span class="c003"><img src="./Differentiation and Integration_files/thinkdsp051.png"></span></div><span class="c003">
</span><div class="caption"><table class="c000 cellpading0"><tbody><tr><td class="c014"><span class="c003">Figure 9.4: Comparison of daily price changes computed by
</span><span class="c003"><span class="c002">np.diff</span></span><span class="c003"> and by applying the differentiation filter.</span></td></tr>
</tbody></table></div><span class="c003">
</span><a id="fig.diff_int4"></a><span class="c003">
</span><div class="center"><hr class="c015"></div></blockquote><p><span class="c003">Figure&nbsp;</span><a href="http://greenteapress.com/thinkdsp/html/thinkdsp010.html#fig.diff_int4"><span class="c003">9.4</span></a><span class="c003"> compares the daily price changes computed by
</span><span class="c003"><span class="c002">np.diff</span></span><span class="c003"> with the derivative we just computed.
I selected the first 50 values in the time series so we can see the
differences more clearly.</span></p><p><span class="c003">The derivative is noisier, because it amplifies the high frequency
components more, as shown in Figure&nbsp;</span><a href="http://greenteapress.com/thinkdsp/html/thinkdsp010.html#fig.diff_int3"><span class="c003">9.3</span></a><span class="c003"> (left). Also, the
first few elements of the derivative are very noisy. The problem
there is that the DFT-based derivative is based on the assumption that
the signal is periodic. In effect, it connects the last element in
the time series back to the first element, which creates artifacts at
the boundaries.
</span><a id="hevea_default354"></a></p><p><span class="c003">To summarize, we have shown:</span></p><ul class="itemize"><li class="li-itemize"><span class="c003"> <span class="c003">Computing the difference between successive values in a signal
can be expressed as convolution with a simple window. The result is
an approximation of the first derivative.</span></span></li><li class="li-itemize"><span class="c003">Differentiation in the time domain corresponds to a simple
filter in the frequency domain. For periodic signals, the result is
the first derivative, exactly. For some non-periodic signals, it
can approximate the derivative.</span></li></ul><p><span class="c003">Using the DFT to compute derivatives is the basis of </span><span class="c003"><span class="c007">spectral
methods</span></span><span class="c003"> for solving differential equations (see
</span><a href="http://en.wikipedia.org/wiki/Spectral_method"><span class="c003"><span class="c002">http://en.wikipedia.org/wiki/Spectral_method</span></span></a><span class="c003">).
</span><a id="hevea_default355"></a></p><p><span class="c003">In particular, it is useful for the analysis of linear, time-invariant
systems, which is coming up in Chapter&nbsp;</span><a href="http://greenteapress.com/thinkdsp/html/thinkdsp011.html#systems"><span class="c003">10</span></a><span class="c003">.</span></p><span class="c003">
</span><h2 class="section" id="sec78"><span class="c003">9.4&nbsp;&nbsp;Integration</span></h2>
<blockquote class="figure"><div class="center"><hr class="c015"></div><span class="c003">
</span><div class="center"><span class="c003"><img src="./Differentiation and Integration_files/thinkdsp052.png"></span></div><span class="c003">
</span><div class="caption"><table class="c000 cellpading0"><tbody><tr><td class="c014"><span class="c003">Figure 9.5: Comparison of the original time series and the integrated
derivative.</span></td></tr>
</tbody></table></div><span class="c003">
</span><a id="fig.diff_int5"></a><span class="c003">
</span><div class="center"><hr class="c015"></div></blockquote><p><span class="c003">In the previous section, we showed that differentiation in the time
domain corresponds to a simple filter in the frequency domain: it
multiplies each component by </span><span class="c003">2 &#960; </span><span class="c003"><span class="c006">i</span></span><span class="c003"> </span><span class="c003"><span class="c006">f</span></span><span class="c003">. Since integration is
the inverse of differentiation, it also corresponds to a simple
filter: it divides each component by </span><span class="c003">2 &#960; </span><span class="c003"><span class="c006">i</span></span><span class="c003"> </span><span class="c003"><span class="c006">f</span></span><span class="c003">.
</span><a id="hevea_default356"></a></p><p><span class="c003">We can compute this filter like this:</span></p><pre class="verbatim"><span class="c003">    integ_filter = close.make_spectrum()
    integ_filter.hs = 1 / (PI2 * 1j * integ_filter.fs)
</span></pre><p><span class="c003">Figure&nbsp;</span><a href="http://greenteapress.com/thinkdsp/html/thinkdsp010.html#fig.diff_int3"><span class="c003">9.3</span></a><span class="c003"> (right) shows this filter on a log-</span><span class="c003"><span class="c006">y</span></span><span class="c003"> scale,
which makes it easier to see.
</span><a id="hevea_default357"></a></p><p><span class="c003"><span class="c002">Spectrum</span></span><span class="c003"> provides a method that applies the integration filter:</span></p><pre class="verbatim"><span class="c003"># class Spectrum:

    def integrate(self):
        self.hs /= PI2 * 1j * self.fs
</span></pre><p><span class="c003">We can confirm that the integration filter is correct by applying it
to the spectrum of the derivative we just computed:</span></p><pre class="verbatim"><span class="c003">    integ_spectrum = deriv_spectrum.copy()
    integ_spectrum.integrate()
</span></pre><p><span class="c003">But notice that at </span><span class="c003"><span class="c006">f</span></span><span class="c003">=0</span><span class="c003">, we are dividing by 0. The result in
NumPy is NaN, which is a special floating-point value that
represents “not a number”. We can partially deal with this
problem by setting this value to 0 before converting the
spectrum back to a wave:
</span><a id="hevea_default358"></a></p><pre class="verbatim"><span class="c003">    integ_spectrum.hs[0] = 0
    integ_wave = integ_spectrum.make_wave()
</span></pre><p><span class="c003">Figure&nbsp;</span><a href="http://greenteapress.com/thinkdsp/html/thinkdsp010.html#fig.diff_int5"><span class="c003">9.5</span></a><span class="c003"> shows this integrated derivative along with
the original time series. They are almost identical, but the
integrated derivative has been shifted down. The problem is that when
we clobbered the </span><span class="c003"><span class="c006">f</span></span><span class="c003">=0</span><span class="c003"> component, we set the bias of the signal to 0.
But that should not be surprising; in general, differentiation loses
information about the bias, and integration can’t recover it. In some
sense, the NaN at </span><span class="c003"><span class="c006">f</span></span><span class="c003">=0</span><span class="c003"> is telling us that this element is unknown.
</span><a id="hevea_default359"></a></p><blockquote class="figure"><div class="center"><hr class="c015"></div><span class="c003">
</span><div class="center"><span class="c003"><img src="./Differentiation and Integration_files/thinkdsp053.png"></span></div><span class="c003">
</span><div class="caption"><table class="c000 cellpading0"><tbody><tr><td class="c014"><span class="c003">Figure 9.6: A sawtooth wave and its spectrum.</span></td></tr>
</tbody></table></div><span class="c003">
</span><a id="fig.diff_int6"></a><span class="c003">
</span><div class="center"><hr class="c015"></div></blockquote><p><span class="c003">If we provide this “constant of integration”, the results are
identical, which confirms that this integration filter is the correct
inverse of the differentiation filter.</span></p><span class="c003">
</span><h2 class="section" id="sec79"><span class="c003">9.5&nbsp;&nbsp;Cumulative sum</span></h2>
<p><span class="c003">
</span><a id="cumsum"></a></p><p><span class="c003">In the same way that the diff operator approximates differentiation,
the cumulative sum approximates integration.
I’ll demonstrate with a Sawtooth signal.
</span><a id="hevea_default360"></a></p><pre class="verbatim"><span class="c003">    signal = thinkdsp.SawtoothSignal(freq=50)
    in_wave = signal.make_wave(duration=0.1, framerate=44100)
</span></pre><p><span class="c003">Figure&nbsp;</span><a href="http://greenteapress.com/thinkdsp/html/thinkdsp010.html#fig.diff_int6"><span class="c003">9.6</span></a><span class="c003"> shows this wave and its spectrum.</span></p><p><span class="c003"><span class="c002">Wave</span></span><span class="c003"> provides a method that computes the cumulative sum of
a wave array and returns a new Wave object:</span></p><pre class="verbatim"><span class="c003"># class Wave:

    def cumsum(self):
        ys = np.cumsum(self.ys)
        ts = self.ts.copy()
        return Wave(ys, ts, self.framerate)
</span></pre><p><span class="c003">We can use it to compute the cumulative sum of </span><code><span class="c003">in_wave</span></code><span class="c003">:</span></p><pre class="verbatim"><span class="c003">    out_wave = in_wave.cumsum()
    out_wave.unbias()
</span></pre><blockquote class="figure"><div class="center"><hr class="c015"></div><span class="c003">
</span><div class="center"><span class="c003"><img src="./Differentiation and Integration_files/thinkdsp054.png"></span></div><span class="c003">
</span><div class="caption"><table class="c000 cellpading0"><tbody><tr><td class="c014"><span class="c003">Figure 9.7: A parabolic wave and its spectrum.</span></td></tr>
</tbody></table></div><span class="c003">
</span><a id="fig.diff_int7"></a><span class="c003">
</span><div class="center"><hr class="c015"></div></blockquote><p><span class="c003">Figure&nbsp;</span><a href="http://greenteapress.com/thinkdsp/html/thinkdsp010.html#fig.diff_int7"><span class="c003">9.7</span></a><span class="c003"> shows the resulting wave and its spectrum.
If you did the exercises in Chapter&nbsp;</span><a href="http://greenteapress.com/thinkdsp/html/thinkdsp003.html#harmonics"><span class="c003">2</span></a><span class="c003">, this waveform should
look familiar: it’s a parabolic signal.
</span><a id="hevea_default361"></a></p><p><span class="c003">Comparing the spectrum of the parabolic signal to the spectrum of the
sawtooth, the amplitudes of the components drop off more quickly. In
Chapter&nbsp;</span><a href="http://greenteapress.com/thinkdsp/html/thinkdsp003.html#harmonics"><span class="c003">2</span></a><span class="c003">, we saw that the components of the sawtooth
drop off in proportion to </span><span class="c003">1/</span><span class="c003"><span class="c006">f</span></span><span class="c003">. Since the cumulative sum
approximates integration, and integration filters components in
proportion to </span><span class="c003">1/</span><span class="c003"><span class="c006">f</span></span><span class="c003">, the components of the parabolic wave drop off in
proportion to </span><span class="c003">1/</span><span class="c003"><span class="c006">f</span></span><sup><span class="c003">2</span></sup><span class="c003">.
</span><a id="hevea_default362"></a></p><p><span class="c003">We can see that graphically by computing the filter that corresponds
to the cumulative sum:</span></p><pre class="verbatim"><span class="c003">    cumsum_filter = diff_filter.copy()
    cumsum_filter.hs = 1 / cumsum_filter.hs
</span></pre><p><span class="c003">Because </span><span class="c003"><span class="c002">cumsum</span></span><span class="c003"> is the inverse operation of </span><span class="c003"><span class="c002">diff</span></span><span class="c003">, we
start with a copy of </span><code><span class="c003">diff_filter</span></code><span class="c003">, which is the filter
that corresponds to the </span><span class="c003"><span class="c002">diff</span></span><span class="c003"> operation, and then invert the
</span><span class="c003"><span class="c002">hs</span></span><span class="c003">.</span></p><blockquote class="figure"><div class="center"><hr class="c015"></div><span class="c003">
</span><div class="center"><span class="c003"><img src="./Differentiation and Integration_files/thinkdsp055.png"></span></div><span class="c003">
</span><div class="caption"><table class="c000 cellpading0"><tbody><tr><td class="c014"><span class="c003">Figure 9.8: Filters corresponding to cumulative sum and integration.</span></td></tr>
</tbody></table></div><span class="c003">
</span><a id="fig.diff_int8"></a><span class="c003">
</span><div class="center"><hr class="c015"></div></blockquote><p><span class="c003">Figure&nbsp;</span><a href="http://greenteapress.com/thinkdsp/html/thinkdsp010.html#fig.diff_int8"><span class="c003">9.8</span></a><span class="c003"> shows the filters corresponding to
cumulative sum and integration. The cumulative sum is a good
approximation of integration except at the highest frequencies,
where it drops off a little faster. </span></p><p><span class="c003">To confirm that this is the correct filter for the cumulative
sum, we can compare it to the ratio of the spectrum
</span><code><span class="c003">out_wave</span></code><span class="c003"> to the spectrum of </span><code><span class="c003">in_wave</span></code><span class="c003">:</span></p><pre class="verbatim"><span class="c003">    in_spectrum = in_wave.make_spectrum()
    out_spectrum = out_wave.make_spectrum()
    ratio_spectrum = out_spectrum.ratio(in_spectrum, thresh=1)
</span></pre><blockquote class="figure"><div class="center"><hr class="c015"></div><span class="c003">
</span><div class="center"><span class="c003"><img src="./Differentiation and Integration_files/thinkdsp056.png"></span></div><span class="c003">
</span><div class="caption"><table class="c000 cellpading0"><tbody><tr><td class="c014"><span class="c003">Figure 9.9: Filter corresponding to cumulative sum and actual ratios of
the before-and-after spectrums.</span></td></tr>
</tbody></table></div><span class="c003">
</span><a id="fig.diff_int9"></a><span class="c003">
</span><div class="center"><hr class="c015"></div></blockquote><p><span class="c003">And here’s the method that computes the ratios:</span></p><pre class="verbatim"><span class="c003">    def ratio(self, denom, thresh=1):
        ratio_spectrum = self.copy()
        ratio_spectrum.hs /= denom.hs
        ratio_spectrum.hs[denom.amps &lt; thresh] = np.nan
        return ratio_spectrum
</span></pre><p><span class="c003">When </span><span class="c003"><span class="c002">denom.amps</span></span><span class="c003"> is small, the resulting ratio is noisy,
so I set those values to NaN.</span></p><p><span class="c003">Figure&nbsp;</span><a href="http://greenteapress.com/thinkdsp/html/thinkdsp010.html#fig.diff_int9"><span class="c003">9.9</span></a><span class="c003"> shows the ratios and the filter
corresponding to the cumulative sum. They agree, which confirms that
inverting the filter for </span><span class="c003"><span class="c002">diff</span></span><span class="c003"> yields the filter for </span><span class="c003"><span class="c002">cumsum</span></span><span class="c003">.</span></p><p><span class="c003">Finally, we can confirm that the Convolution Theorem applies by
applying the </span><span class="c003"><span class="c002">cumsum</span></span><span class="c003"> filter in the frequency domain:
</span><a id="hevea_default363"></a></p><pre class="verbatim"><span class="c003">    out_wave2 = (in_spectrum * cumsum_filter).make_wave()
</span></pre><p><span class="c003">Within the limits of floating-point error, </span><code><span class="c003">out_wave2</span></code><span class="c003"> is
identical to </span><code><span class="c003">out_wave</span></code><span class="c003">, which we computed using </span><span class="c003"><span class="c002">cumsum</span></span><span class="c003">, so
the Convolution Theorem works! But note that this demonstration only
works with periodic signals.</span></p><span class="c003">
</span><h2 class="section" id="sec80"><span class="c003">9.6&nbsp;&nbsp;Integrating noise</span></h2>
<p><span class="c003">
</span><a id="integratenoise"></a></p><p><span class="c003">In Section&nbsp;</span><a href="http://greenteapress.com/thinkdsp/html/thinkdsp005.html#brownian"><span class="c003">4.3</span></a><span class="c003">, we generated Brownian noise by computing the
cumulative sum of white noise.
Now that we understand the effect of </span><span class="c003"><span class="c002">cumsum</span></span><span class="c003"> in the frequency
domain, we have some insight into the spectrum of Brownian noise.
</span><a id="hevea_default364"></a></p><p><span class="c003">White noise has equal power at all frequencies, on average. When we
compute the cumulative sum, the amplitude of each component is divided
by </span><span class="c003"><span class="c006">f</span></span><span class="c003">. Since power is the square of magnitude, the power of each
component is divided by </span><span class="c003"><span class="c006">f</span></span><sup><span class="c003">2</span></sup><span class="c003">. So on average, the power at frequency
</span><span class="c003"><span class="c006">f</span></span><span class="c003"> is proportional to </span><span class="c003">1 / </span><span class="c003"><span class="c006">f</span></span><sup><span class="c003">2</span></sup><span class="c003">:
</span></p><table class="display dcenter"><tbody><tr class="c013"><td class="dcell"><span class="c003"><span class="c006">P</span></span><sub><span class="c003"><span class="c006">f</span></span></sub><span class="c003">&nbsp;=&nbsp;</span><span class="c003"><span class="c006">K</span></span><span class="c003">&nbsp;/&nbsp;</span><span class="c003"><span class="c006">f</span></span><sup><span class="c003">2</span></sup><span class="c003">&nbsp;</span></td></tr>
</tbody></table><p><span class="c003">
where </span><span class="c003"><span class="c006">K</span></span><span class="c003"> is a constant that’s not important.
Taking the log of both sides yields:
</span></p><table class="display dcenter"><tbody><tr class="c013"><td class="dcell"><span class="c003">log</span><span class="c003"><span class="c006">P</span></span><sub><span class="c003"><span class="c006">f</span></span></sub><span class="c003">&nbsp;=&nbsp;</span><span class="c003">log</span><span class="c003"><span class="c006">K</span></span><span class="c003">&nbsp;&#8722;&nbsp;2&nbsp;</span><span class="c003">log</span><span class="c003"><span class="c006">f</span></span><span class="c003">&nbsp;</span></td></tr>
</tbody></table><p><span class="c003">
And that’s why, when we plot the spectrum of Brownian noise on a
log-log scale, we expect to see a straight line with slope -2, at
least approximately.
</span><a id="hevea_default365"></a></p><p><span class="c003">In Section&nbsp;</span><a href="http://greenteapress.com/thinkdsp/html/thinkdsp010.html#diffs"><span class="c003">9.1</span></a><span class="c003"> we plotted the spectrum of closing prices for
Facebook, and estimated that the slope is -1.9, which is consistent
with Brownian noise. Many stock prices have similar spectrums.
</span><a id="hevea_default366"></a><span class="c003">
</span><a id="hevea_default367"></a></p><p><span class="c003">When we use the </span><span class="c003"><span class="c002">diff</span></span><span class="c003"> operator to compute daily changes, we
multiplied the </span><span class="c003"><em>amplitude</em></span><span class="c003"> of each component by a filter proportional to
</span><span class="c003"><span class="c006">f</span></span><span class="c003">, which means we multiplied the </span><span class="c003"><em>power</em></span><span class="c003"> of each component by </span><span class="c003"><span class="c006">f</span></span><sup><span class="c003">2</span></sup><span class="c003">.
On a log-log scale, this operation adds 2 to the slope of the
power spectrum, which is why the estimated slope of the result
is near 0.1 (but a little lower, because </span><span class="c003"><span class="c002">diff</span></span><span class="c003"> only approximates
differentiation).</span></p><span class="c003">
</span><h2 class="section" id="sec81"><span class="c003">9.7&nbsp;&nbsp;Exercises</span></h2>
<p><span class="c003">Solutions to these exercises are in </span><span class="c003"><span class="c002">chap09soln.ipynb</span></span><span class="c003">.</span></p><div class="theorem"><span class="c003"><span class="c007">Exercise&nbsp;1</span></span><span class="c003">&nbsp;&nbsp;<em>
The notebook for this chapter is </em></span><span class="c003"><em><span class="c002">chap09.ipynb</span></em></span><span class="c003"><em>.
Read through it and run the code.</em></span><p><span class="c003"><em>In Section&nbsp;</em></span><a href="http://greenteapress.com/thinkdsp/html/thinkdsp010.html#cumsum"><span class="c003"><em>9.5</em></span></a><span class="c003"><em>, I mentioned that some of the
examples don’t work with non-periodic signals. Try replacing the
sawtooth wave, which is periodic, with the Facebook data, which is
not, and see what goes wrong.
</em></span><a id="hevea_default368"></a></p></div><div class="theorem"><span class="c003"><span class="c007">Exercise&nbsp;2</span></span><span class="c003">&nbsp;&nbsp;<em>
The goal of this exercise is to explore the effect of </em></span><span class="c003"><em><span class="c002">diff</span></em></span><span class="c003"><em> and
</em></span><span class="c003"><em><span class="c002">differentiate</span></em></span><span class="c003"><em> on a signal. Create a triangle wave and plot
it. Apply </em></span><span class="c003"><em><span class="c002">diff</span></em></span><span class="c003"><em> and plot the result. Compute the spectrum of the
triangle wave, apply </em></span><span class="c003"><em><span class="c002">differentiate</span></em></span><span class="c003"><em>, and plot the result. Convert
the spectrum back to a wave and plot it. Are there differences between
the effect of </em></span><span class="c003"><em><span class="c002">diff</span></em></span><span class="c003"><em> and </em></span><span class="c003"><em><span class="c002">differentiate</span></em></span><span class="c003"><em> for this wave?
</em></span><a id="hevea_default369"></a><span class="c003"><em>
</em></span><a id="hevea_default370"></a></div><div class="theorem"><span class="c003"><span class="c007">Exercise&nbsp;3</span></span><span class="c003">&nbsp;&nbsp;<em>
The goal of this exercise is to explore the effect of </em></span><span class="c003"><em><span class="c002">cumsum</span></em></span><span class="c003"><em> and
</em></span><span class="c003"><em><span class="c002">integrate</span></em></span><span class="c003"><em> on a signal. Create a square wave and plot it. Apply
</em></span><span class="c003"><em><span class="c002">cumsum</span></em></span><span class="c003"><em> and plot the result. Compute the spectrum of the square
wave, apply </em></span><span class="c003"><em><span class="c002">integrate</span></em></span><span class="c003"><em>, and plot the result. Convert the spectrum
back to a wave and plot it. Are there differences between the effect
of </em></span><span class="c003"><em><span class="c002">cumsum</span></em></span><span class="c003"><em> and </em></span><span class="c003"><em><span class="c002">integrate</span></em></span><span class="c003"><em> for this wave?
</em></span><a id="hevea_default371"></a><span class="c003"><em>
</em></span><a id="hevea_default372"></a></div><div class="theorem"><span class="c003"><span class="c007">Exercise&nbsp;4</span></span><span class="c003">&nbsp;&nbsp;<em>
The goal of this exercise is the explore the effect of integrating
twice. Create a sawtooth wave, compute its spectrum, then apply </em></span><span class="c003"><em><span class="c002">integrate</span></em></span><span class="c003"><em> twice. Plot the resulting wave and its spectrum. What is
the mathematical form of the wave? Why does it resemble a sinusoid?
</em></span><a id="hevea_default373"></a></div><div class="theorem"><span class="c003"><span class="c007">Exercise&nbsp;5</span></span><span class="c003">&nbsp;&nbsp;<em>
The goal of this exercise is to explore the effect of the 2nd
difference and 2nd derivative. Create a </em></span><span class="c003"><em><span class="c002">CubicSignal</span></em></span><span class="c003"><em>, which is
defined in </em></span><span class="c003"><em><span class="c002">thinkdsp</span></em></span><span class="c003"><em>. Compute the second difference by applying
</em></span><span class="c003"><em><span class="c002">diff</span></em></span><span class="c003"><em> twice. What does the result look like? Compute the second
derivative by applying </em></span><span class="c003"><em><span class="c002">differentiate</span></em></span><span class="c003"><em> to the spectrum twice.
Does the result look the same?</em></span><p><span class="c003"><em>Plot the filters that correspond to the 2nd difference and the 2nd
derivative and compare them. Hint: In order to get the filters on the
same scale, use a wave with frame rate 1.
</em></span><a id="hevea_default374"></a></p></div><span class="c003">
</span></td>

<td width="130" valign="top">

<p>
</p><h4>Are you using one of our books in a class?</h4>  We'd like to know
about it.  Please consider filling out <a href="http://spreadsheets.google.com/viewform?formkey=dC0tNUZkMjBEdXVoRGljNm9FRmlTMHc6MA" onclick="javascript: pageTracker._trackPageview(&#39;/outbound/survey&#39;);">this short survey</a>.

<p>
<br>

</p><p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491938455/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1491938455&amp;linkCode=as2&amp;tag=greenteapre01-20&amp;linkId=2JJH4SWCAVVYSQHO">Think DSP</a><img class="c001" src="./Differentiation and Integration_files/ir" width="1" height="1" border="0" alt="">

</p><p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491938455/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1491938455&amp;linkCode=as2&amp;tag=greenteapre01-20&amp;linkId=CTV7PDT7E5EGGJUM"><img border="0" src="./Differentiation and Integration_files/q"></a><img class="c001" src="./Differentiation and Integration_files/ir" width="1" height="1" border="0" alt="">

</p><p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491929561/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1491929561&amp;linkCode=as2&amp;tag=greenteapre01-20&amp;linkId=ZY6MAYM33ZTNSCNZ">Think Java</a><img class="c001" src="./Differentiation and Integration_files/ir(1)" width="1" height="1" border="0" alt="">

</p><p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491929561/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1491929561&amp;linkCode=as2&amp;tag=greenteapre01-20&amp;linkId=PT77ANWARUNNU3UK"><img border="0" src="./Differentiation and Integration_files/q(1)"></a><img class="c001" src="./Differentiation and Integration_files/ir(1)" width="1" height="1" border="0" alt="">

</p><p>
<a href="http://www.amazon.com/gp/product/1449370780/ref=as_li_qf_sp_asin_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1449370780&amp;linkCode=as2&amp;tag=greenteapre01-20">Think Bayes</a><img class="c001" src="./Differentiation and Integration_files/ir(2)" width="1" height="1" border="0" alt="">

</p><p>
<a href="http://www.amazon.com/gp/product/1449370780/ref=as_li_qf_sp_asin_il?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1449370780&amp;linkCode=as2&amp;tag=greenteapre01-20"><img border="0" src="./Differentiation and Integration_files/q(2)"></a><img class="c001" src="./Differentiation and Integration_files/ir(2)" width="1" height="1" border="0" alt="">

</p><p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491939362/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1491939362&amp;linkCode=as2&amp;tag=greenteapre01-20&amp;linkId=FJKSQ3IHEMY2F2VA">Think Python 2e</a><img class="c001" src="./Differentiation and Integration_files/ir(3)" width="1" height="1" border="0" alt="">


</p><p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491939362/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1491939362&amp;linkCode=as2&amp;tag=greenteapre01-20&amp;linkId=ZZ454DLQ3IXDHNHX"><img border="0" src="./Differentiation and Integration_files/q(3)"></a><img class="c001" src="./Differentiation and Integration_files/ir(3)" width="1" height="1" border="0" alt="">

</p><p>
<a href="http://www.amazon.com/gp/product/1491907339/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1491907339&amp;linkCode=as2&amp;tag=greenteapre01-20&amp;linkId=O7WYM6H6YBYUFNWU">Think Stats 2e</a><img class="c001" src="./Differentiation and Integration_files/ir(4)" width="1" height="1" border="0" alt="">

</p><p>
<a href="http://www.amazon.com/gp/product/1491907339/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1491907339&amp;linkCode=as2&amp;tag=greenteapre01-20&amp;linkId=JVSYKQHYSUIEYRHL"><img border="0" src="./Differentiation and Integration_files/q(4)"></a><img class="c001" src="./Differentiation and Integration_files/ir(4)" width="1" height="1" border="0" alt="">

</p><p>
<a href="http://www.amazon.com/gp/product/1449314635/ref=as_li_tf_tl?ie=UTF8&amp;tag=greenteapre01-20&amp;linkCode=as2&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1449314635">Think Complexity</a><img class="c001" src="./Differentiation and Integration_files/ir(5)" width="1" height="1" border="0" alt="">

</p><p>
<a href="http://www.amazon.com/gp/product/1449314635/ref=as_li_tf_il?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1449314635&amp;linkCode=as2&amp;tag=greenteapre01-20"><img border="0" src="./Differentiation and Integration_files/q(5)"></a><img class="c001" src="./Differentiation and Integration_files/ir(5)" width="1" height="1" border="0" alt="">


</p></td>
</tr>
</tbody></table>


<hr>
<a href="http://greenteapress.com/thinkdsp/html/thinkdsp009.html"><img src="./Differentiation and Integration_files/back.png" alt="Previous"></a>
<a href="http://greenteapress.com/thinkdsp/html/index.html"><img src="./Differentiation and Integration_files/up.png" alt="Up"></a>
<a href="http://greenteapress.com/thinkdsp/html/thinkdsp011.html"><img src="./Differentiation and Integration_files/next.png" alt="Next"></a>


<iframe frameborder="0" scrolling="no" style="background-color: transparent; border: 0px; display: none;" src="./Differentiation and Integration_files/saved_resource.html"></iframe><div id="GOOGLE_INPUT_CHEXT_FLAG" style="display: none;" input="" input_stat="{&quot;tlang&quot;:true,&quot;tsbc&quot;:true,&quot;pun&quot;:true,&quot;mk&quot;:true,&quot;ss&quot;:true}"></div><div id="speechnotesx_mirror_container"><div id="speechnotesx_mirror"></div></div></body></html>