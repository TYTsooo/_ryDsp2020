<!DOCTYPE html>
<!-- saved from url=(0055)http://greenteapress.com/thinkdsp/html/thinkdsp002.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252">

<meta name="generator" content="hevea 2.09">
<link rel="stylesheet" type="text/css" href="./Sounds and signals_files/thinkdsp.css">
<title>Sounds and signals</title>
<style id="dark-reader-style" type="text/css">@media screen {

/* Leading rule */
html {
  -webkit-filter: invert(100%) hue-rotate(180deg) brightness(110%) contrast(90%) grayscale(20%) sepia(10%) !important;
  filter: invert(100%) hue-rotate(180deg) brightness(110%) contrast(90%) grayscale(20%) sepia(10%) !important;
}

/* Reverse rule */
img,
video,
:not(object):not(body)>embed,
object,
svg image,
[style*="background:url"],
[style*="background-image:url"],
[style*="background: url"],
[style*="background-image: url"],
[background],
twitterwidget {
  -webkit-filter: invert(100%) hue-rotate(180deg) !important;
  filter: invert(100%) hue-rotate(180deg) !important;
}
[style*="background:url"] *,
[style*="background-image:url"] *,
[style*="background: url"] *,
[style*="background-image: url"] *,
input,
[background] *,
img[src^="https://s0.wp.com/latex.php"],
twitterwidget .NaturalImage-image {
  -webkit-filter: none !important;
  filter: none !important;
}
.compatibility-with-darkreader-below-4-3-3 {
  background: white !important;
}

/* Text contrast */
html {
  text-shadow: 0 0 0 !important;
}

/* Full screen */
:-webkit-full-screen, :-webkit-full-screen * {
  -webkit-filter: none !important;
  filter: none !important;
}
:-moz-full-screen, :-moz-full-screen * {
  -webkit-filter: none !important;
  filter: none !important;
}
:fullscreen, :fullscreen * {
  -webkit-filter: none !important;
  filter: none !important;
}

/* Page background */
html {
  background: rgb(13,13,12) !important;
}

/* Custom rules */
.compatibility-with-darkreader-below-4-3-3 {
    background: white !important;
}

}</style></head>
<body class="">
<a href="http://greenteapress.com/thinkdsp/html/thinkdsp001.html"><img src="./Sounds and signals_files/back.png" alt="Previous"></a>
<a href="http://greenteapress.com/thinkdsp/html/index.html"><img src="./Sounds and signals_files/up.png" alt="Up"></a>
<a href="http://greenteapress.com/thinkdsp/html/thinkdsp003.html"><img src="./Sounds and signals_files/next.png" alt="Next"></a>
<hr>
<table>

<tbody><tr>

<td valign="top" width="100" bgcolor="#b53f97">
</td>

<td valign="top" width="600" style="padding: 20px 20px;">

<p>This HTML version of is provided for convenience, but it
is not the best format for the book.  In particular, some of the
symbols are not rendered correctly.

</p><p>You might prefer to read
the <a href="http://greenteapress.com/thinkdsp/thinkdsp.pdf">PDF version</a>.

</p><p>
<a href="http://amzn.to/1T8U0mR">You can buy this book at Amazon.</a>
</p><h1 class="chapter" id="sec5"><span class="c003">Chapter&nbsp;1&nbsp;&nbsp;Sounds and signals</span></h1>
<p><span class="c003">
</span><a id="sounds"></a></p><p><span class="c003">A </span><span class="c003"><span class="c007">signal</span></span><span class="c003"> represents a quantity that varies in time. That
definition is pretty abstract, so let’s start with a concrete example:
sound. Sound is variation in air pressure. A sound signal represents
variations in air pressure over time.
</span><a id="hevea_default19"></a><span class="c003">
</span><a id="hevea_default20"></a></p><p><span class="c003">A microphone is a device that measures these variations and generates
an electrical signal that represents sound. A speaker is a device
that takes an electrical signal and produces sound.
Microphones and speakers are called </span><span class="c003"><span class="c007">transducers</span></span><span class="c003"> because they
transduce, or convert, signals from one form to another.
</span><a id="hevea_default21"></a></p><p><span class="c003">This book is about signal processing, which includes processes for
synthesizing, transforming, and analyzing signals. I will focus on
sound signals, but the same methods apply to electronic signals,
mechanical vibration, and signals in many other domains.</span></p><p><span class="c003">They also apply to signals that vary in space rather than time, like
elevation along a hiking trail. And they apply to signals in more
than one dimension, like an image, which you can think of as a signal
that varies in two-dimensional space. Or a movie, which is
a signal that varies in two-dimensional space </span><span class="c003"><span class="c006">and</span></span><span class="c003"> time.</span></p><p><span class="c003">But we start with simple one-dimensional sound.</span></p><p><span class="c003">The code for this chapter is in </span><span class="c003"><span class="c002">chap01.ipynb</span></span><span class="c003">, which is in the
repository for this book (see Section&nbsp;</span><a href="http://greenteapress.com/thinkdsp/html/thinkdsp001.html#code"><span class="c003">0.2</span></a><span class="c003">).
You can also view it at </span><a href="http://tinyurl.com/thinkdsp01"><span class="c003"><span class="c002">http://tinyurl.com/thinkdsp01</span></span></a><span class="c003">.</span></p><span class="c003">
</span><h2 class="section" id="sec6"><span class="c003">1.1&nbsp;&nbsp;Periodic signals</span></h2>
<p><span class="c003">
</span><a id="violin"></a></p><blockquote class="figure"><div class="center"><hr class="c015"></div><span class="c003">
</span><div class="center"><span class="c003"><img src="./Sounds and signals_files/thinkdsp001.png"></span></div><span class="c003">
</span><div class="caption"><table class="c000 cellpading0"><tbody><tr><td class="c014"><span class="c003">Figure 1.1: Segment from a recording of a bell.</span></td></tr>
</tbody></table></div><span class="c003">
</span><a id="fig.sounds1"></a><span class="c003">
</span><div class="center"><hr class="c015"></div></blockquote><p><span class="c003">We’ll start with </span><span class="c003"><span class="c007">periodic signals</span></span><span class="c003">, which are signals that
repeat themselves after some period of time. For example, if you
strike a bell, it vibrates and generates sound. If you record
that sound and plot the transduced signal, it looks like
Figure&nbsp;</span><a href="http://greenteapress.com/thinkdsp/html/thinkdsp002.html#fig.sounds1"><span class="c003">1.1</span></a><span class="c003">.
</span><a id="hevea_default22"></a></p><p><span class="c003">This signal resembles a </span><span class="c003"><span class="c007">sinusoid</span></span><span class="c003">, which means it has the same
shape as the trigonometric sine function.
</span><a id="hevea_default23"></a></p><p><span class="c003">You can see that this signal is periodic. I chose the duration
to show three full repetitions, also known as </span><span class="c003"><span class="c007">cycles</span></span><span class="c003">.
The duration of each cycle, called the </span><span class="c003"><span class="c007">period</span></span><span class="c003">, is about 2.3 ms.
</span><a id="hevea_default24"></a><span class="c003">
</span><a id="hevea_default25"></a></p><p><span class="c003">The </span><span class="c003"><span class="c007">frequency</span></span><span class="c003"> of a signal is the number of cycles
per second, which is the inverse of the period.
The units of frequency are cycles per second, or </span><span class="c003"><span class="c007">Hertz</span></span><span class="c003">,
abbreviated “Hz”. (Strictly speaking, the number of cycles is
a dimensionless number, so a Hertz is really a “per second”).
</span><a id="hevea_default26"></a><span class="c003">
</span><a id="hevea_default27"></a></p><p><span class="c003">The frequency of this signal is about 439 Hz, slightly lower than 440
Hz, which is the standard tuning pitch for orchestral music. The
musical name of this note is A, or more specifically, A4. If you are
not familiar with “scientific pitch notation”, the numerical suffix
indicates which octave the note is in. A4 is the A above middle C.
A5 is one octave higher. See
</span><a href="http://en.wikipedia.org/wiki/Scientific_pitch_notation"><span class="c003"><span class="c002">http://en.wikipedia.org/wiki/Scientific_pitch_notation</span></span></a><span class="c003">.
</span><a id="hevea_default28"></a><span class="c003">
</span><a id="hevea_default29"></a></p><blockquote class="figure"><div class="center"><hr class="c015"></div><span class="c003">
</span><div class="center"><span class="c003"><img src="./Sounds and signals_files/thinkdsp002.png"></span></div><span class="c003">
</span><div class="caption"><table class="c000 cellpading0"><tbody><tr><td class="c014"><span class="c003">Figure 1.2: Segment from a recording of a violin.</span></td></tr>
</tbody></table></div><span class="c003">
</span><a id="fig.sounds2"></a><span class="c003">
</span><div class="center"><hr class="c015"></div></blockquote><p><span class="c003">A tuning fork generates a sinusoid because the vibration of the tines
is a form of simple harmonic motion. Most musical instruments
produce periodic signals, but the shape of these signals is not
sinusoidal. For example, Figure&nbsp;</span><a href="http://greenteapress.com/thinkdsp/html/thinkdsp002.html#fig.sounds2"><span class="c003">1.2</span></a><span class="c003"> shows a segment
from a recording of a violin playing
Boccherini’s String Quintet No. 5 in E, 3rd
movement.
</span><a id="hevea_default30"></a><span class="c003">
</span><a id="hevea_default31"></a></p><p><span class="c003">Again we can see that the signal is periodic, but the shape of the
signal is more complex. The shape of a periodic signal is called
the </span><span class="c003"><span class="c007">waveform</span></span><span class="c003">. Most musical instruments produce waveforms more
complex than a sinusoid. The shape of the waveform determines the
musical </span><span class="c003"><span class="c007">timbre</span></span><span class="c003">, which is our perception of the quality of the
sound. People usually perceive complex waveforms as rich, warm and
more interesting than sinusoids.
</span><a id="hevea_default32"></a><span class="c003">
</span><a id="hevea_default33"></a></p><span class="c003">
</span><h2 class="section" id="sec7"><span class="c003">1.2&nbsp;&nbsp;Spectral decomposition</span></h2>
<blockquote class="figure"><div class="center"><hr class="c015"></div><span class="c003">
</span><div class="center"><span class="c003"><img src="./Sounds and signals_files/thinkdsp003.png"></span></div><span class="c003">
</span><div class="caption"><table class="c000 cellpading0"><tbody><tr><td class="c014"><span class="c003">Figure 1.3: Spectrum of a segment from the violin recording.</span></td></tr>
</tbody></table></div><span class="c003">
</span><a id="fig.sounds3"></a><span class="c003">
</span><div class="center"><hr class="c015"></div></blockquote><p><span class="c003">The most important topic in this book is </span><span class="c003"><span class="c007">spectral decomposition</span></span><span class="c003">,
which is the idea that any signal can be expressed as the sum of
sinusoids with different frequencies.
</span><a id="hevea_default34"></a></p><p><span class="c003">The most important mathematical idea in this book is the </span><span class="c003"><span class="c007">Discrete
Fourier Transform</span></span><span class="c003">, or </span><span class="c003"><span class="c007">DFT</span></span><span class="c003">, which takes a signal and produces
its </span><span class="c003"><span class="c007">spectrum</span></span><span class="c003">. The spectrum is the set of sinusoids that add up to
produce the signal.
</span><a id="hevea_default35"></a><span class="c003">
</span><a id="hevea_default36"></a></p><p><span class="c003">And the most important algorithm in this book is the </span><span class="c003"><span class="c007">Fast
Fourier Transform</span></span><span class="c003">, or </span><span class="c003"><span class="c007">FFT</span></span><span class="c003">, which is an efficient way to
compute the DFT.
</span><a id="hevea_default37"></a><span class="c003">
</span><a id="hevea_default38"></a></p><p><span class="c003">For example, Figure&nbsp;</span><a href="http://greenteapress.com/thinkdsp/html/thinkdsp002.html#fig.sounds3"><span class="c003">1.3</span></a><span class="c003"> shows the spectrum of the violin
recording in Figure&nbsp;</span><a href="http://greenteapress.com/thinkdsp/html/thinkdsp002.html#fig.sounds2"><span class="c003">1.2</span></a><span class="c003">. The x-axis is the range of
frequencies that make up the signal. The y-axis shows the strength
or </span><span class="c003"><span class="c007">amplitude</span></span><span class="c003"> of each frequency component.
</span><a id="hevea_default39"></a><span class="c003">
</span><a id="hevea_default40"></a></p><p><span class="c003">The lowest frequency component is called the </span><span class="c003"><span class="c007">fundamental
frequency</span></span><span class="c003">. The fundamental frequency of this signal is near 440 Hz
(actually a little lower, or “flat”).
</span><a id="hevea_default41"></a></p><p><span class="c003">In this signal the fundamental frequency has the largest amplitude,
so it is also the </span><span class="c003"><span class="c007">dominant frequency</span></span><span class="c003">.
Normally the perceived pitch of a sound is determined by the
fundamental frequency, even if it is not dominant. 
</span><a id="hevea_default42"></a></p><p><span class="c003">The other spikes in the spectrum are at frequencies 880, 1320, 1760, and
2200, which are integer multiples of the fundamental.
These components are called </span><span class="c003"><span class="c007">harmonics</span></span><span class="c003"> because they are
musically harmonious with the fundamental:
</span><a id="hevea_default43"></a></p><ul class="itemize"><li class="li-itemize"><span class="c003">880 is the frequency of A5, one octave higher than the fundamental. 
An </span><span class="c003"><span class="c007">octave</span></span><span class="c003"> is a doubling in frequency.
</span><a id="hevea_default44"></a></li><li class="li-itemize"><span class="c003">1320 is approximately E6, which is a perfect fifth above A5.
If you are not familiar with musical intervals like "perfect fifth”, see
</span><a href="https://en.wikipedia.org/wiki/Interval_(music)"><span class="c003"><span class="c002">https://en.wikipedia.org/wiki/Interval_(music)</span></span></a><span class="c003">.
</span><a id="hevea_default45"></a></li><li class="li-itemize"><span class="c003">1760 is A6, two octaves above the fundamental. </span></li><li class="li-itemize"><span class="c003">2200 is approximately C</span><span class="c003">&#9839;</span><span class="c003">7, which is a major third
above A6.
</span><a id="hevea_default46"></a></li></ul><p><span class="c003">These harmonics make up the notes of an A major
chord, although not all in the same octave. Some of them are only
approximate because the notes that make up Western music have been
adjusted for </span><span class="c003"><span class="c007">equal temperament</span></span><span class="c003"> (see
</span><a href="http://en.wikipedia.org/wiki/Equal_temperament"><span class="c003"><span class="c002">http://en.wikipedia.org/wiki/Equal_temperament</span></span></a><span class="c003">).
</span><a id="hevea_default47"></a><span class="c003">
</span><a id="hevea_default48"></a></p><p><span class="c003">Given the harmonics and their amplitudes, you can reconstruct the
signal by adding up sinusoids. 
Next we’ll see how.</span></p><span class="c003">
</span><h2 class="section" id="sec8"><span class="c003">1.3&nbsp;&nbsp;Signals</span></h2>
<p><span class="c003">I wrote a Python module called </span><span class="c003"><span class="c002">thinkdsp.py</span></span><span class="c003"> that contains classes
and functions for working with signals and spectrums</span><sup><a id="text1" href="http://greenteapress.com/thinkdsp/html/thinkdsp002.html#note1"><span class="c003">1</span></a></sup><span class="c003">. You
will find it in the repository for this book (see Section&nbsp;</span><a href="http://greenteapress.com/thinkdsp/html/thinkdsp001.html#code"><span class="c003">0.2</span></a><span class="c003">).
</span><a id="hevea_default49"></a></p><p><span class="c003">To represent signals, </span><span class="c003"><span class="c002">thinkdsp</span></span><span class="c003"> provides a class called
</span><span class="c003"><span class="c002">Signal</span></span><span class="c003">, which is the parent class for several signal types,
including </span><span class="c003"><span class="c002">Sinusoid</span></span><span class="c003">, which represents both sine and cosine
signals.</span></p><p><span class="c003"><span class="c002">thinkdsp</span></span><span class="c003"> provides functions to create sine and cosine signals:
</span><a id="hevea_default50"></a><span class="c003">
</span><a id="hevea_default51"></a></p><pre class="verbatim"><span class="c003">    cos_sig = thinkdsp.CosSignal(freq=440, amp=1.0, offset=0)
    sin_sig = thinkdsp.SinSignal(freq=880, amp=0.5, offset=0)
</span></pre><p><span class="c003"><span class="c002">freq</span></span><span class="c003"> is frequency in Hz. </span><span class="c003"><span class="c002">amp</span></span><span class="c003"> is amplitude in unspecified
units where 1.0 is defined as the largest amplitude we can record or
play back.</span></p><p><span class="c003"><span class="c002">offset</span></span><span class="c003"> is a </span><span class="c003"><span class="c007">phase offset</span></span><span class="c003"> in radians. Phase offset
determines where in the period the signal starts. For example, a
sine signal with </span><span class="c003"><span class="c002">offset=0</span></span><span class="c003"> starts at </span><span class="c003">sin</span><span class="c003">0</span><span class="c003">, which is 0.
With </span><span class="c003"><span class="c002">offset=pi/2</span></span><span class="c003"> it starts at </span><span class="c003">sin</span><span class="c003">&#960;/2</span><span class="c003">, which is 1.
</span><a id="hevea_default52"></a></p><p><span class="c003">Signals have an </span><code><span class="c003">__add__</span></code><span class="c003"> method, so you can use the </span><span class="c003"><span class="c002">+</span></span><span class="c003">
operator to add them:</span></p><pre class="verbatim"><span class="c003">    mix = sin_sig + cos_sig
</span></pre><p><span class="c003">The result is a </span><span class="c003"><span class="c002">SumSignal</span></span><span class="c003">, which represents the sum of two
or more signals.
</span><a id="hevea_default53"></a><span class="c003">
</span><a id="hevea_default54"></a><span class="c003">
</span><a id="hevea_default55"></a><span class="c003">
</span><a id="hevea_default56"></a><span class="c003">
</span><a id="hevea_default57"></a></p><p><span class="c003">A Signal is basically a Python representation of a mathematical
function. Most signals are defined for all values of </span><span class="c003"><span class="c002">t</span></span><span class="c003">,
from negative infinity to infinity.</span></p><p><span class="c003">You can’t do much with a Signal until you evaluate it. In this
context, “evaluate” means taking a sequence of points in time, </span><span class="c003"><span class="c002">ts</span></span><span class="c003">, and computing the corresponding values of the signal, </span><span class="c003"><span class="c002">ys</span></span><span class="c003">.
I represent </span><span class="c003"><span class="c002">ts</span></span><span class="c003"> and </span><span class="c003"><span class="c002">ys</span></span><span class="c003"> using NumPy arrays and encapsulate
them in an object called a Wave.
</span><a id="hevea_default58"></a></p><p><span class="c003">A Wave represents a signal evaluated at a sequence of points in
time. Each point in time is called a </span><span class="c003"><span class="c007">frame</span></span><span class="c003"> (a term borrowed
from movies and video). The measurement itself is called a
</span><span class="c003"><span class="c007">sample</span></span><span class="c003">, although “frame” and “sample” are sometimes
used interchangeably.
</span><a id="hevea_default59"></a><span class="c003">
</span><a id="hevea_default60"></a></p><p><span class="c003"><span class="c002">Signal</span></span><span class="c003"> provides </span><code><span class="c003">make_wave</span></code><span class="c003">, which returns a new
Wave object:</span></p><pre class="verbatim"><span class="c003">    wave = mix.make_wave(duration=0.5, start=0, framerate=11025)
</span></pre><p><span class="c003"><span class="c002">duration</span></span><span class="c003"> is the length of the Wave in seconds. </span><span class="c003"><span class="c002">start</span></span><span class="c003"> is
the start time, also in seconds. </span><span class="c003"><span class="c002">framerate</span></span><span class="c003"> is the (integer)
number of frames per second, which is also the number of samples
per second.</span></p><p><span class="c003">11,025 frames per second is one of several framerates commonly used in
audio file formats, including Waveform Audio File (WAV) and mp3. </span></p><p><span class="c003">This example evaluates the signal from </span><span class="c003"><span class="c002">t=0</span></span><span class="c003"> to </span><span class="c003"><span class="c002">t=0.5</span></span><span class="c003"> at
5,513 equally-spaced frames (because 5,513 is half of 11,025).
The time between frames, or </span><span class="c003"><span class="c007">timestep</span></span><span class="c003">, is </span><span class="c003"><span class="c002">1/11025</span></span><span class="c003"> seconds, about
91 </span><span class="c003">µ</span><span class="c003">s.
</span><a id="hevea_default61"></a></p><p><span class="c003"><span class="c002">Wave</span></span><span class="c003"> provides a </span><span class="c003"><span class="c002">plot</span></span><span class="c003"> method that uses </span><span class="c003"><span class="c002">pyplot</span></span><span class="c003">.
You can plot the wave like this:</span></p><pre class="verbatim"><span class="c003">    wave.plot()
    pyplot.show()
</span></pre><p><span class="c003"><span class="c002">pyplot</span></span><span class="c003"> is part of </span><span class="c003"><span class="c002">matplotlib</span></span><span class="c003">; it is included in many
Python distributions, or you might have to install it.</span></p><blockquote class="figure"><div class="center"><hr class="c015"></div><span class="c003">
</span><div class="center"><span class="c003"><img src="./Sounds and signals_files/thinkdsp004.png"></span></div><span class="c003">
</span><div class="caption"><table class="c000 cellpading0"><tbody><tr><td class="c014"><span class="c003">Figure 1.4: Segment from a mixture of two sinusoid signals.</span></td></tr>
</tbody></table></div><span class="c003">
</span><a id="fig.sounds4"></a><span class="c003">
</span><div class="center"><hr class="c015"></div></blockquote><p><span class="c003">At </span><span class="c003"><span class="c002">freq=440</span></span><span class="c003"> there are 220 periods in 0.5 seconds, so this plot
would look like a solid block of color. To zoom in on a small number
of periods, we can use </span><span class="c003"><span class="c002">segment</span></span><span class="c003">, which copies a segment of a Wave
and returns a new wave:</span></p><pre class="verbatim"><span class="c003">    period = mix.period
    segment = wave.segment(start=0, duration=period*3)
</span></pre><p><span class="c003"><span class="c002">period</span></span><span class="c003"> is a property of a Signal; it returns the period in seconds.</span></p><p><span class="c003"><span class="c002">start</span></span><span class="c003"> and </span><span class="c003"><span class="c002">duration</span></span><span class="c003"> are in seconds. This example copies
the first three periods from </span><span class="c003"><span class="c002">mix</span></span><span class="c003">. The result is a Wave object.
</span><a id="hevea_default62"></a></p><p><span class="c003">If we plot </span><span class="c003"><span class="c002">segment</span></span><span class="c003">, it looks like Figure&nbsp;</span><a href="http://greenteapress.com/thinkdsp/html/thinkdsp002.html#fig.sounds4"><span class="c003">1.4</span></a><span class="c003">.
This signal contains two frequency components, so it is more
complicated than the signal from the tuning fork, but less complicated
than the violin.
</span><a id="hevea_default63"></a><span class="c003">
</span><a id="hevea_default64"></a></p><span class="c003">
</span><h2 class="section" id="sec9"><span class="c003">1.4&nbsp;&nbsp;Reading and writing Waves</span></h2>
<p><span class="c003"><span class="c002">thinkdsp</span></span><span class="c003"> provides </span><code><span class="c003">read_wave</span></code><span class="c003">, which reads a WAV
file and returns a Wave:
</span><a id="hevea_default65"></a></p><pre class="verbatim"><span class="c003">    violin_wave = thinkdsp.read_wave('input.wav')
</span></pre><p><span class="c003">And </span><span class="c003"><span class="c002">Wave</span></span><span class="c003"> provides </span><span class="c003"><span class="c002">write</span></span><span class="c003">, which writes a WAV file:</span></p><pre class="verbatim"><span class="c003">    wave.write(filename='output.wav')
</span></pre><p><span class="c003">You can listen to the Wave with any media player that plays WAV
files. On UNIX systems, I use </span><span class="c003"><span class="c002">aplay</span></span><span class="c003">, which is simple, robust,
and included in many Linux distributions.
</span><a id="hevea_default66"></a></p><p><span class="c003"><span class="c002">thinkdsp</span></span><span class="c003"> also provides </span><code><span class="c003">play_wave</span></code><span class="c003">, which runs
the media player as a subprocess:</span></p><pre class="verbatim"><span class="c003">    thinkdsp.play_wave(filename='output.wav', player='aplay')
</span></pre><p><span class="c003">It uses </span><span class="c003"><span class="c002">aplay</span></span><span class="c003"> by default, but you can provide the
name of another player.</span></p><span class="c003">
</span><h2 class="section" id="sec10"><span class="c003">1.5&nbsp;&nbsp;Spectrums</span></h2>
<p><span class="c003">
</span><a id="spectrums"></a></p><p><span class="c003"><span class="c002">Wave</span></span><span class="c003"> provides </span><code><span class="c003">make_spectrum</span></code><span class="c003">, which returns a
</span><span class="c003"><span class="c002">Spectrum</span></span><span class="c003">:</span></p><pre class="verbatim"><span class="c003">    spectrum = wave.make_spectrum()
</span></pre><p><span class="c003">And </span><span class="c003"><span class="c002">Spectrum</span></span><span class="c003"> provides </span><span class="c003"><span class="c002">plot</span></span><span class="c003">:</span></p><pre class="verbatim"><span class="c003">    spectrum.plot()
    thinkplot.show()
</span></pre><p><span class="c003"><span class="c002">thinkplot</span></span><span class="c003"> is a module I wrote to provide wrappers around some of
the functions in </span><span class="c003"><span class="c002">pyplot</span></span><span class="c003">. It is included in the
Git repository for this book (see Section&nbsp;</span><a href="http://greenteapress.com/thinkdsp/html/thinkdsp001.html#code"><span class="c003">0.2</span></a><span class="c003">).
</span><a id="hevea_default67"></a><span class="c003">
</span><a id="hevea_default68"></a><span class="c003">
</span><a id="hevea_default69"></a><span class="c003">
</span><a id="hevea_default70"></a></p><p><span class="c003"><span class="c002">Spectrum</span></span><span class="c003"> provides three methods that modify the spectrum:</span></p><ul class="itemize"><li class="li-itemize"><code><span class="c003">low_pass</span></code><span class="c003"> applies a low-pass filter, which means that
components above a given cutoff frequency are </span><span class="c003"><span class="c007">attenuated</span></span><span class="c003"> (that is,
reduced in magnitude) by a factor.</span></li><li class="li-itemize"><code><span class="c003">high_pass</span></code><span class="c003"> applies a high-pass filter, which means that
it attenuates components below the cutoff.</span></li><li class="li-itemize"><code><span class="c003">band_stop</span></code><span class="c003"> attenuates components in the band of
frequencies between two cutoffs.</span></li></ul><p><span class="c003">This example attenuates all frequencies above 600 by 99%:</span></p><pre class="verbatim"><span class="c003">   spectrum.low_pass(cutoff=600, factor=0.01)
</span></pre><p><span class="c003">A low-pass filter removes bright, high-frequency sounds, so
the result sounds muffled and darker. To hear what it sounds
like, you can convert the Spectrum back to a Wave, and then play it.</span></p><pre class="verbatim"><span class="c003">    wave = spectrum.make_wave()
    wave.play('temp.wav')
</span></pre><p><span class="c003">The </span><span class="c003"><span class="c002">play</span></span><span class="c003"> method writes the wave to a file and then plays it.
If you use Jupyter notebooks, you can use </span><code><span class="c003">make_audio</span></code><span class="c003">, which
makes an Audio widget that plays the sound.
</span><a id="hevea_default71"></a><span class="c003">
</span><a id="hevea_default72"></a></p><span class="c003">
</span><h2 class="section" id="sec11"><span class="c003">1.6&nbsp;&nbsp;Wave objects</span></h2>
<blockquote class="figure"><div class="center"><hr class="c015"></div><span class="c003">
</span><div class="center"><span class="c003"><img src="./Sounds and signals_files/thinkdsp005.png"></span></div><span class="c003">
</span><div class="caption"><table class="c000 cellpading0"><tbody><tr><td class="c014"><span class="c003">Figure 1.5: Relationships among the classes in </span><span class="c003"><span class="c002">thinkdsp</span></span><span class="c003">.</span></td></tr>
</tbody></table></div><span class="c003">
</span><a id="fig.diagram1"></a><span class="c003">
</span><div class="center"><hr class="c015"></div></blockquote><p><span class="c003">There is nothing very complicated in </span><span class="c003"><span class="c002">thinkdsp.py</span></span><span class="c003">. Most
of the functions it provides are thin wrappers around functions
from NumPy and SciPy.</span></p><p><span class="c003">The primary classes in </span><span class="c003"><span class="c002">thinkdsp</span></span><span class="c003"> are Signal, Wave, and Spectrum.
Given a Signal, you can make a Wave. Given a Wave, you can
make a Spectrum, and vice versa. These relationships are shown
in Figure&nbsp;</span><a href="http://greenteapress.com/thinkdsp/html/thinkdsp002.html#fig.diagram1"><span class="c003">1.5</span></a><span class="c003">.</span></p><p><span class="c003">A Wave object contains three attributes: </span><span class="c003"><span class="c002">ys</span></span><span class="c003"> is a NumPy array
that contains the values in the signal; </span><span class="c003"><span class="c002">ts</span></span><span class="c003"> is an array of the
times where the signal was evaluated or sampled; and </span><span class="c003"><span class="c002">framerate</span></span><span class="c003"> is the number of samples per unit of time. The
unit of time is usually seconds, but it doesn’t have to be. In
one of my examples, it’s days.
</span><a id="hevea_default73"></a></p><p><span class="c003">Wave also provides three read-only properties: </span><span class="c003"><span class="c002">start</span></span><span class="c003">,
</span><span class="c003"><span class="c002">end</span></span><span class="c003">, and </span><span class="c003"><span class="c002">duration</span></span><span class="c003">. If you modify </span><span class="c003"><span class="c002">ts</span></span><span class="c003">, these
properties change accordingly.</span></p><p><span class="c003">To modify a wave, you can access the </span><span class="c003"><span class="c002">ts</span></span><span class="c003"> and </span><span class="c003"><span class="c002">ys</span></span><span class="c003"> directly.
For example:</span></p><pre class="verbatim"><span class="c003">wave.ys *= 2
wave.ts += 1
</span></pre><p><span class="c003">The first line scales the wave by a factor of 2, making
it louder. The second line shifts the wave in time, making it
start 1 second later.
</span><a id="hevea_default74"></a><span class="c003">
</span><a id="hevea_default75"></a></p><p><span class="c003">But Wave provides methods that perform many common operations.
For example, the same two transformations could be written:</span></p><pre class="verbatim"><span class="c003">wave.scale(2)
wave.shift(1)
</span></pre><p><span class="c003">You can read the documentation of these methods and others at
</span><a href="http://greenteapress.com/thinkdsp.html"><span class="c003"><span class="c002">http://greenteapress.com/thinkdsp.html</span></span></a><span class="c003">.</span></p><span class="c003">
</span><h2 class="section" id="sec12"><span class="c003">1.7&nbsp;&nbsp;Signal objects</span></h2>
<p><span class="c003">
</span><a id="sigobs"></a></p><p><span class="c003">Signal is a parent class that provides functions common to all
kinds of signals, like </span><code><span class="c003">make_wave</span></code><span class="c003">. Child classes inherit
these methods and provide </span><span class="c003"><span class="c002">evaluate</span></span><span class="c003">, which evaluates the
signal at a given sequence of times.
</span><a id="hevea_default76"></a><span class="c003">
</span><a id="hevea_default77"></a></p><p><span class="c003">For example, Sinusoid is a child class of Signal, with this
definition:</span></p><pre class="verbatim"><span class="c003">class Sinusoid(Signal):
    
    def __init__(self, freq=440, amp=1.0, offset=0, func=np.sin):
        Signal.__init__(self)
        self.freq = freq
        self.amp = amp
        self.offset = offset
        self.func = func
</span></pre><p><span class="c003">The parameters of </span><code><span class="c003">__init__</span></code><span class="c003"> are:</span></p><ul class="itemize"><li class="li-itemize"><span class="c003"><span class="c002">freq</span></span><span class="c003">: frequency in cycles per second, or Hz.</span></li><li class="li-itemize"><span class="c003"><span class="c002">amp</span></span><span class="c003">: amplitude. The units of amplitude are arbitrary,
usually chosen so 1.0 corresponds to the maximum input from a
microphone or maximum output to a speaker.</span></li><li class="li-itemize"><span class="c003"><span class="c002">offset</span></span><span class="c003">: indicates where in its period the signal starts;
</span><span class="c003"><span class="c002">offset</span></span><span class="c003"> is in units of radians, for reasons I explain below.</span></li><li class="li-itemize"><span class="c003"><span class="c002">func</span></span><span class="c003">: a Python function used
to evaluate the signal at a particular point in time. It is
usually either </span><span class="c003"><span class="c002">np.sin</span></span><span class="c003"> or </span><span class="c003"><span class="c002">np.cos</span></span><span class="c003">, yielding a sine or
cosine signal.</span></li></ul><p><span class="c003">Like many init methods, this one just tucks the parameters away for
future use.</span></p><p><span class="c003">Signal provides </span><code><span class="c003">make_wave</span></code><span class="c003">, which looks like
this:</span></p><pre class="verbatim"><span class="c003">    def make_wave(self, duration=1, start=0, framerate=11025):
        n = round(duration * framerate)
        ts = start + np.arange(n) / framerate
        ys = self.evaluate(ts)
        return Wave(ys, ts, framerate=framerate)
</span></pre><p><span class="c003"><span class="c002">start</span></span><span class="c003"> and </span><span class="c003"><span class="c002">duration</span></span><span class="c003"> are the start time and duration
in seconds. </span><span class="c003"><span class="c002">framerate</span></span><span class="c003"> is the number of frames (samples)
per second.</span></p><p><span class="c003"><span class="c002">n</span></span><span class="c003"> is the number of samples, and </span><span class="c003"><span class="c002">ts</span></span><span class="c003"> is a NumPy array
of sample times.</span></p><p><span class="c003">To compute the </span><span class="c003"><span class="c002">ys</span></span><span class="c003">, </span><code><span class="c003">make_wave</span></code><span class="c003"> invokes </span><span class="c003"><span class="c002">evaluate</span></span><span class="c003">, 
which is provided by </span><span class="c003"><span class="c002">Sinusoid</span></span><span class="c003">:</span></p><pre class="verbatim"><span class="c003">    def evaluate(self, ts):
        phases = PI2 * self.freq * ts + self.offset
        ys = self.amp * self.func(phases)
        return ys
</span></pre><p><span class="c003">Let’s unwind this function one step at time:</span></p><ol class="enumerate" type="1"><li class="li-enumerate"><span class="c003"><span class="c002">self.freq</span></span><span class="c003"> is frequency in cycles per second, and each
element of </span><span class="c003"><span class="c002">ts</span></span><span class="c003"> is a time in seconds, so their product is the
number of cycles since the start time.</span></li><li class="li-enumerate"><span class="c003"><span class="c002">PI2</span></span><span class="c003"> is a constant that stores </span><span class="c003">2 &#960;</span><span class="c003">. Multiplying by
</span><span class="c003"><span class="c002">PI2</span></span><span class="c003"> converts from cycles to </span><span class="c003"><span class="c007">phase</span></span><span class="c003">. You can think of
phase as “cycles since the start time” expressed in radians. Each
cycle is </span><span class="c003">2 &#960;</span><span class="c003"> radians.</span></li><li class="li-enumerate"><span class="c003"><span class="c002">self.offset</span></span><span class="c003"> is the phase when </span><span class="c003"><span class="c006">t</span></span><span class="c003">=0</span><span class="c003">.
It has the effect of shifting the signal left or right in time.</span></li><li class="li-enumerate"><span class="c003">If </span><span class="c003"><span class="c002">self.func</span></span><span class="c003"> is </span><span class="c003"><span class="c002">np.sin</span></span><span class="c003"> or </span><span class="c003"><span class="c002">np.cos</span></span><span class="c003">, the result is a
value between </span><span class="c003">&#8722;1</span><span class="c003"> and </span><span class="c003">+1</span><span class="c003">.</span></li><li class="li-enumerate"><span class="c003">Multiplying by </span><span class="c003"><span class="c002">self.amp</span></span><span class="c003"> yields a signal that ranges from
</span><span class="c003"><span class="c002">-self.amp</span></span><span class="c003"> to </span><span class="c003"><span class="c002">+self.amp</span></span><span class="c003">.</span></li></ol><p><span class="c003">In math notation, </span><span class="c003"><span class="c002">evaluate</span></span><span class="c003"> is written like this:
</span></p><table class="display dcenter"><tbody><tr class="c013"><td class="dcell"><span class="c003"><span class="c006">y</span></span><span class="c003">&nbsp;=&nbsp;</span><span class="c003"><span class="c006">A</span></span><span class="c003">&nbsp;</span><span class="c003">cos</span><span class="c003">(2&nbsp;&#960;&nbsp;</span><span class="c003"><span class="c006">f</span></span><span class="c003">&nbsp;</span><span class="c003"><span class="c006">t</span></span><span class="c003">&nbsp;+&nbsp;&#966;</span><sub><span class="c003">0</span></sub><span class="c003">)&nbsp;</span></td></tr>
</tbody></table><p><span class="c003">
where </span><span class="c003"><span class="c006">A</span></span><span class="c003"> is amplitude, </span><span class="c003"><span class="c006">f</span></span><span class="c003"> is frequency, </span><span class="c003"><span class="c006">t</span></span><span class="c003"> is time, and </span><span class="c003">&#966;</span><sub><span class="c003">0</span></sub><span class="c003">
is the phase offset. It may seem like I wrote a lot of code
to evaluate one simple expression, but as we’ll see, this code
provides a framework for dealing with all kinds of signals, not
just sinusoids.
</span><a id="hevea_default78"></a><span class="c003">
</span><a id="hevea_default79"></a><span class="c003">
</span><a id="hevea_default80"></a></p><span class="c003">
</span><h2 class="section" id="sec13"><span class="c003">1.8&nbsp;&nbsp;Exercises</span></h2>
<p><span class="c003">Before you begin these exercises, you should download the code
for this book, following the instructions in Section&nbsp;</span><a href="http://greenteapress.com/thinkdsp/html/thinkdsp001.html#code"><span class="c003">0.2</span></a><span class="c003">.</span></p><p><span class="c003">Solutions to these exercises are in </span><span class="c003"><span class="c002">chap01soln.ipynb</span></span><span class="c003">.</span></p><div class="theorem"><span class="c003"><span class="c007">Exercise&nbsp;1</span></span><span class="c003">&nbsp;&nbsp;<em>
If you have Jupyter, load </em></span><span class="c003"><em><span class="c002">chap01.ipynb</span></em></span><span class="c003"><em>, read through it, and run
the examples. You can also view this notebook at
</em></span><a href="http://tinyurl.com/thinkdsp01"><span class="c003"><em><span class="c002">http://tinyurl.com/thinkdsp01</span></em></span></a><span class="c003"><em>.
</em></span></div><div class="theorem"><span class="c003"><span class="c007">Exercise&nbsp;2</span></span><span class="c003">&nbsp;&nbsp;<em>
Go to </em></span><a href="http://freesound.org/"><span class="c003"><em><span class="c002">http://freesound.org</span></em></span></a><span class="c003"><em> and download a sound sample that
includes music, speech, or other sounds that have a well-defined pitch.
Select a roughly half-second segment where the pitch is
constant. Compute and plot the spectrum of the segment you selected.
What connection can you make between the timbre of the sound and the
harmonic structure you see in the spectrum?
</em></span><a id="hevea_default81"></a><p><span class="c003"><em>Use </em></span><code><span class="c003"><em>high_pass</em></span></code><span class="c003"><em>, </em></span><code><span class="c003"><em>low_pass</em></span></code><span class="c003"><em>, and </em></span><code><span class="c003"><em>band_stop</em></span></code><span class="c003"><em> to
filter out some of the harmonics. Then convert the spectrum back
to a wave and listen to it. How does the sound relate to the
changes you made in the spectrum?
</em></span></p></div><div class="theorem"><span class="c003"><span class="c007">Exercise&nbsp;3</span></span><span class="c003">&nbsp;&nbsp;<em>
Synthesize a compound signal by creating SinSignal and CosSignal
objects and adding them up. Evaluate the signal to get a Wave,
and listen to it. Compute its Spectrum and plot it.
What happens if you add frequency
components that are not multiples of the fundamental?
</em></span><a id="hevea_default82"></a></div><div class="theorem"><span class="c003"><span class="c007">Exercise&nbsp;4</span></span><span class="c003">&nbsp;&nbsp;<em>
Write a function called </em></span><span class="c003"><em><span class="c002">stretch</span></em></span><span class="c003"><em> that takes a Wave and a stretch
factor and speeds up or slows down the wave by modifying </em></span><span class="c003"><em><span class="c002">ts</span></em></span><span class="c003"><em> and
</em></span><span class="c003"><em><span class="c002">framerate</span></em></span><span class="c003"><em>. Hint: it should only take two lines of code.
</em></span><a id="hevea_default83"></a><span class="c003"><em>
</em></span></div><span class="c003">
</span><hr class="footnoterule"><dl class="thefootnotes"><dt class="dt-thefootnotes"><span class="c003">
</span><a id="note1" href="http://greenteapress.com/thinkdsp/html/thinkdsp002.html#text1"><span class="c003">1</span></a></dt><dd class="dd-thefootnotes"><span class="c003"><div class="footnotetext">The
plural of “spectrum” is often written “spectra”, but I prefer
to use standard English plurals. If you are familiar with “spectra”,
I hope my choice doesn’t sound too strange.</div>
</span></dd></dl>
</td>

<td width="130" valign="top">

<p>
</p><h4>Are you using one of our books in a class?</h4>  We'd like to know
about it.  Please consider filling out <a href="http://spreadsheets.google.com/viewform?formkey=dC0tNUZkMjBEdXVoRGljNm9FRmlTMHc6MA" onclick="javascript: pageTracker._trackPageview(&#39;/outbound/survey&#39;);">this short survey</a>.

<p>
<br>

</p><p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491938455/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1491938455&amp;linkCode=as2&amp;tag=greenteapre01-20&amp;linkId=2JJH4SWCAVVYSQHO">Think DSP</a><img class="c001" src="./Sounds and signals_files/ir" width="1" height="1" border="0" alt="">

</p><p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491938455/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1491938455&amp;linkCode=as2&amp;tag=greenteapre01-20&amp;linkId=CTV7PDT7E5EGGJUM"><img border="0" src="./Sounds and signals_files/q"></a><img class="c001" src="./Sounds and signals_files/ir" width="1" height="1" border="0" alt="">

</p><p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491929561/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1491929561&amp;linkCode=as2&amp;tag=greenteapre01-20&amp;linkId=ZY6MAYM33ZTNSCNZ">Think Java</a><img class="c001" src="./Sounds and signals_files/ir(1)" width="1" height="1" border="0" alt="">

</p><p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491929561/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1491929561&amp;linkCode=as2&amp;tag=greenteapre01-20&amp;linkId=PT77ANWARUNNU3UK"><img border="0" src="./Sounds and signals_files/q(1)"></a><img class="c001" src="./Sounds and signals_files/ir(1)" width="1" height="1" border="0" alt="">

</p><p>
<a href="http://www.amazon.com/gp/product/1449370780/ref=as_li_qf_sp_asin_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1449370780&amp;linkCode=as2&amp;tag=greenteapre01-20">Think Bayes</a><img class="c001" src="./Sounds and signals_files/ir(2)" width="1" height="1" border="0" alt="">

</p><p>
<a href="http://www.amazon.com/gp/product/1449370780/ref=as_li_qf_sp_asin_il?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1449370780&amp;linkCode=as2&amp;tag=greenteapre01-20"><img border="0" src="./Sounds and signals_files/q(2)"></a><img class="c001" src="./Sounds and signals_files/ir(2)" width="1" height="1" border="0" alt="">

</p><p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491939362/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1491939362&amp;linkCode=as2&amp;tag=greenteapre01-20&amp;linkId=FJKSQ3IHEMY2F2VA">Think Python 2e</a><img class="c001" src="./Sounds and signals_files/ir(3)" width="1" height="1" border="0" alt="">


</p><p>
<a rel="nofollow" href="http://www.amazon.com/gp/product/1491939362/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1491939362&amp;linkCode=as2&amp;tag=greenteapre01-20&amp;linkId=ZZ454DLQ3IXDHNHX"><img border="0" src="./Sounds and signals_files/q(3)"></a><img class="c001" src="./Sounds and signals_files/ir(3)" width="1" height="1" border="0" alt="">

</p><p>
<a href="http://www.amazon.com/gp/product/1491907339/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1491907339&amp;linkCode=as2&amp;tag=greenteapre01-20&amp;linkId=O7WYM6H6YBYUFNWU">Think Stats 2e</a><img class="c001" src="./Sounds and signals_files/ir(4)" width="1" height="1" border="0" alt="">

</p><p>
<a href="http://www.amazon.com/gp/product/1491907339/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1491907339&amp;linkCode=as2&amp;tag=greenteapre01-20&amp;linkId=JVSYKQHYSUIEYRHL"><img border="0" src="./Sounds and signals_files/q(4)"></a><img class="c001" src="./Sounds and signals_files/ir(4)" width="1" height="1" border="0" alt="">

</p><p>
<a href="http://www.amazon.com/gp/product/1449314635/ref=as_li_tf_tl?ie=UTF8&amp;tag=greenteapre01-20&amp;linkCode=as2&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1449314635">Think Complexity</a><img class="c001" src="./Sounds and signals_files/ir(5)" width="1" height="1" border="0" alt="">

</p><p>
<a href="http://www.amazon.com/gp/product/1449314635/ref=as_li_tf_il?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1449314635&amp;linkCode=as2&amp;tag=greenteapre01-20"><img border="0" src="./Sounds and signals_files/q(5)"></a><img class="c001" src="./Sounds and signals_files/ir(5)" width="1" height="1" border="0" alt="">


</p></td>
</tr>
</tbody></table>


<hr>
<a href="http://greenteapress.com/thinkdsp/html/thinkdsp001.html"><img src="./Sounds and signals_files/back.png" alt="Previous"></a>
<a href="http://greenteapress.com/thinkdsp/html/index.html"><img src="./Sounds and signals_files/up.png" alt="Up"></a>
<a href="http://greenteapress.com/thinkdsp/html/thinkdsp003.html"><img src="./Sounds and signals_files/next.png" alt="Next"></a>


<iframe frameborder="0" scrolling="no" style="background-color: transparent; border: 0px; display: none;" src="./Sounds and signals_files/saved_resource.html"></iframe><div id="GOOGLE_INPUT_CHEXT_FLAG" style="display: none;" input="" input_stat="{&quot;tlang&quot;:true,&quot;tsbc&quot;:true,&quot;pun&quot;:true,&quot;mk&quot;:true,&quot;ss&quot;:true}"></div><div id="speechnotesx_mirror_container"><div id="speechnotesx_mirror"></div></div></body></html>